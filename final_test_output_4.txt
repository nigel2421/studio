PASS src/lib/cache.test.ts
  CacheService
    ÔêÜ should set and get values (9 ms)
    ÔêÜ should return null for non-existent keys (1 ms)
    ÔêÜ should return null for expired keys (2 ms)
    ÔêÜ should handle namespaced clearing (1 ms)
    ÔêÜ should clear everything when no namespace is provided (1 ms)
    ÔêÜ should get or fetch correctly (3 ms)
    ÔêÜ should fetch again after expiration in getOrFetch (1 ms)

PASS src/ai/flows/automated-maintenance-response-drafts.test.ts
  Maintenance Response AI Flow
    ÔêÜ should generate a response for valid input (12 ms)
    ÔêÜ should throw error if AI generation fails (9 ms)

FAIL src/app/actions.test.ts
  ÔùÅ Test suite failed to run

    ReferenceError: TextEncoder is not defined

      32 | // Helper for currency formatting
      33 | const formatCurrency = (amount: number) => `KSh ${(amount || 0).toLocaleString()}`;
    > 34 |
         | ^
      35 | export const generateDocumentPDF = (document: FinancialDocument) => {
      36 |     const doc = new jsPDF();
      37 |

      at Object.<anonymous> (node_modules/iobuffer/src/text.ts:6:17)
      at Object.<anonymous> (node_modules/iobuffer/src/IOBuffer.ts:1:1)
      at Object.<anonymous> (node_modules/fast-png/src/PngDecoder.ts:1:1)
      at Object.<anonymous> (node_modules/fast-png/src/index.ts:1:1)
      at Object.<anonymous> (node_modules/jspdf/dist/jspdf.node.min.js:51:82)
      at Object.<anonymous> (src/lib/pdf-generator.ts:34:55)
      at Object.<anonymous> (src/app/actions.ts:31:23)
      at Object.<anonymous> (src/app/actions.test.ts:10:18)

Test Suites: 1 failed, 2 passed, 3 total
Tests:       9 passed, 9 total
Snapshots:   0 total
Time:        5.706 s
Ran all test suites matching /src\\lib\\cache.test.ts|src\\app\\actions.test.ts|src\\ai\\flows\\automated-maintenance-response-drafts.test.ts/i.
