PASS src/lib/cache.test.ts
  CacheService
    Ã”ÃªÃœ should set and get values (13 ms)
    Ã”ÃªÃœ should return null for non-existent keys (2 ms)
    Ã”ÃªÃœ should return null for expired keys (2 ms)
    Ã”ÃªÃœ should handle namespaced clearing (2 ms)
    Ã”ÃªÃœ should clear everything when no namespace is provided (1 ms)
    Ã”ÃªÃœ should get or fetch correctly (3 ms)
    Ã”ÃªÃœ should fetch again after expiration in getOrFetch (1 ms)

PASS src/ai/flows/automated-maintenance-response-drafts.test.ts
  Maintenance Response AI Flow
    Ã”ÃªÃœ should generate a response for valid input (14 ms)
    Ã”ÃªÃœ should throw error if AI generation fails (10 ms)

  console.error
    Error: AI Busy
        at Object.<anonymous> (C:\Users\USER\Music\WEBSITES\studio-1\src\app\actions.test.ts:109:90)
        at Promise.then.completed (C:\Users\USER\Music\WEBSITES\studio-1\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\USER\Music\WEBSITES\studio-1\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\USER\Music\WEBSITES\studio-1\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\USER\Music\WEBSITES\studio-1\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\USER\Music\WEBSITES\studio-1\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\USER\Music\WEBSITES\studio-1\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\USER\Music\WEBSITES\studio-1\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\USER\Music\WEBSITES\studio-1\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\USER\Music\WEBSITES\studio-1\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\USER\Music\WEBSITES\studio-1\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\USER\Music\WEBSITES\studio-1\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\USER\Music\WEBSITES\studio-1\node_modules\jest-runner\build\runTest.js:444:34)
        at Object.worker (C:\Users\USER\Music\WEBSITES\studio-1\node_modules\jest-runner\build\testWorker.js:106:12)

    [0m [90m 67 |[39m     [36mreturn[39m { success[33m:[39m [36mtrue[39m[33m,[39m data[33m:[39m result }[33m;[39m
     [90m 68 |[39m   } [36mcatch[39m (error[33m:[39m any) {
    [31m[1m>[22m[39m[90m 69 |[39m     console[33m.[39merror(error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 70 |[39m     [36mconst[39m message [33m=[39m error[33m.[39mmessage [33m||[39m [32m'Failed to generate AI draft. Please try again.'[39m[33m;[39m
     [90m 71 |[39m     [36mreturn[39m { success[33m:[39m [36mfalse[39m[33m,[39m error[33m:[39m message }[33m;[39m
     [90m 72 |[39m   }[0m

      at error (src/app/actions.ts:69:13)
      at Object.<anonymous> (src/app/actions.test.ts:111:28)

PASS src/app/actions.test.ts
  Server Actions
    performSendArrearsReminder
      Ã”ÃªÃœ should send reminder if tenant has due balance (32 ms)
      Ã”ÃªÃœ should return error if tenant not found (1 ms)
      Ã”ÃªÃœ should return error if tenant has no balance (1 ms)
    performSendServiceChargeInvoice
      Ã”ÃªÃœ should generate PDF and send email (3 ms)
    getMaintenanceResponseDraft
      Ã”ÃªÃœ should return AI draft on success (1 ms)
      Ã”ÃªÃœ should handle AI errors gracefully (71 ms)

Test Suites: 3 passed, 3 total
Tests:       15 passed, 15 total
Snapshots:   0 total
Time:        5.602 s
Ran all test suites matching /src\\lib\\cache.test.ts|src\\app\\actions.test.ts|src\\ai\\flows\\automated-maintenance-response-drafts.test.ts/i.
